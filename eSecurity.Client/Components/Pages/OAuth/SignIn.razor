@page "/account/oauth/sign-in/"

@inherits PageBase

<Title Text="Sign-in for eSecurity via OAuth"/>

@code {

    [SupplyParameterFromQuery(Name = "redirect_uri")]
    public string? RedirectUri { get; set; }

    protected override void OnInitialized()
    {
        if (string.IsNullOrEmpty(RedirectUri))
        {
            NavigationManager.NavigateTo(QueryBuilder.Create()
                .WithUri(Links.OAuth.Error)
                .WithQueryParam("error", Errors.OAuth.InvalidRequestUri)
                .WithQueryParam("error_description", "The redirect_uri parameter is missing.")
                .Build());
        }
    }
}
